# Alloy Analyzerを軽く使ってみたよ.

## なんの話か?

* モデル設計
  => ホワイトボードの前でやってるやつ
     (設計と一口に言っても広いですが,今回は主にモデルについて)

* テーブルスキーマで満足しがち
  => 一歩進んでValidなモデルを手に入れよう！

* Validなモデル
  => プログラムが処理対象と想定している範囲
  => 顧客の要求機能や性質を保証すべき

## Alloy Analyzerとは

* "軽量"形式手法のツール

* 有界モデル発見器

* 抽象化・設計で利用

## Alloyの特徴

* グラフィカル表示

* 有界
  10億超の莫大な空間探索
　　- テストでは到底不可能なカバレッジ

* 小スコープ仮説
　不具合の原因となる構造は小さな構成要素でも再現可能

## 形式手法って?

* E.W.Dijkstraのお言葉(1972.チューリング賞受賞講演)

  "プログラム・テスティングはバグがあることを示す効果的な方法になるが，バグがないことを示すことは絶望的である."
  => 顧客に言われたらこの言葉を贈ろう.

* 形式手法の目的はバグがないことを示す技術の確立
  => 理想は分かるけど現実は...

## *軽量*形式手法

* 定理証明のような形式手法 => 手間がかかりすぎる
  * そう言えば,強い型付けも形式手法に含めて考える(ことがある)

* "軽量"とは形式的仕様と非形式的なプログラム(水準0) by Wikipedia
　形式仕様記述から開発・検証までするには枝葉末節までやらねばらなずツライ

## 動かしてみる

* これはチュートリアルなので単なるサンプルです.
* 目的はどういうものか?を実際に使ってみせる.

## 仕事で使ってみた

* OPERA
  CRAGEの見積書の構造
  受注(見積書)の構造
  請求処理における状態遷移
  承認プロセスの状態遷移
  ログイン処理における状態遷移

## 知見

* Alloyさんは有能なレビュアー
  * 人間にツッコミ入れられるとイヤだがAlloyのツッコミは楽しい.
* 顧客に対して具体的な構造を挙げて有効(Valid)と考えるのかどうか議論できる.
* 顧客に対して確認すべきことが網羅できている安心感.
* モデルを仕様化する上で明記すべきものが明確になる.

* Alloyさんは設計をしてくれるわけではない
* 状態遷移的なものは手間が急速に大きくなる気がする
* 本は出版されたがあまりWebには情報が少ない
* 数値や文字列などのリテラル表現が不自由
  * ツールは他にもあるので今後試していきたい
